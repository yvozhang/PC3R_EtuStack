<!DOCTYPE html>
<html lang="en">
    <head>
        <title>SO question 4112686</title>

        <script src="./jquery-3.5.0.min.js"></script>
       
    </head>
    <body>  
        <form method="post" action="" id="formLogin">
                  <div class="form-group">
                     <label id="first">Email</label>
                     <input type="text" class="form-control" name="login" placeholder="@mail" required="required" id="login_input">
                  </div>
                  <div class="form-group">
                     <label id="second">Password</label>
                     <input type="password" class="form-control" name="mdp" placeholder="mot de passe" required="required" id="mdp_input" >
                  </div>
                  <button type="submit" class="btn btn-black" id="btn1">Login</button>&emsp;&emsp;&emsp;
              </form>
              
               <script>
        

		function authentification(event){
			
			let url = 'ServletUsers?login='+document.getElementById("login_input").value+'&mdp='+document.getElementById("mdp_input").value;
			console.log("fetch a "+url);
			let headers = new Headers();
			headers.set('Accept', 'application/json');
			
			fetch(url, {method : "post", headers, mode : "same-origin"})
				.then(function(response){
					response.json()
					.then(function(rjson){
						console.log("Recu:" + rjson.resultat);
						/* entree(rjson) */
						document.body.innerHTML += "<h2 color=red> Recu ! </h2>"
					})
					.catch(function(error){console.log("Authentification Parsing: "+error.message)});
			    })
				.catch(function(error){
					console.log("Authentification Fetching: "+error.message);
				})
			}
				document.getElementById("formLogin").addEventListener("submit", function(event)
						{event.preventDefault(); 
						console.log("Connexion."); 
						authentification(event)} );
				
       </script>

        
    </body>
</html>


